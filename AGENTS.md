# Repository Guidelines

## Project Structure & Module Organization
- `src/` TypeScript React app. `components/GraphCanvas/` wraps React Flow; `components/NodeCard.tsx` renders stages; `components/ProgressIndicator.tsx` controls the phase overlay.
- `src/lib/` shared logic: `layout/elk.ts` for node positioning, `adapters/mermaidAdapter.ts` parses Mermaid, `utils/types.ts` central types.
- `src/styles/global.css` defines CSS variables and palette used across components.
- `public/data/graph.mmd` live Mermaid graph loaded at runtime; static shell is in `index.html`.
- `scripts/gen-tree-progressive.js` writes phased graph snapshots to `public/data/`.

## Build, Test, and Development Commands
- `npm install` install dependencies.
- `npm run dev` start Vite at `http://localhost:5173` with HMR.
- `npm run build` create production bundle in `dist/`.
- `npm run preview` serve production build on port 5174.
- `node scripts/gen-tree-progressive.js` regenerate phased `graph.mmd` snapshots.

## Coding Style & Naming Conventions
- Language: strict TypeScript, ES modules; prefer functional React + hooks.
- Formatting: two-space indentation, trailing commas (match `components/GraphCanvas/index.tsx`).
- Naming: components/hooks in PascalCase (e.g., `GraphCanvas`, `useGraphData`); utilities in camelCase; CSS classes in kebab-case.
- Styling: store reusable colors/spacing tokens in `src/styles/global.css`; use module-scoped styles only when necessary.

## Testing Guidelines
- Automated tests are not configured yet; perform manual verification in both `npm run dev` and `npm run preview` builds.
- If adding tests, use Vitest + React Testing Library and co-locate under `src/__tests__/` (e.g., `src/__tests__/GraphCanvas.test.tsx`).
- Prefer assertions on graph node counts/layout stability to catch regressions.

## Commit & Pull Request Guidelines
- Use Conventional Commits (e.g., `feat:`, `fix:`) with concise scope and subjects under 60 chars.
- Group related changes; document breaking updates with a `BREAKING CHANGE` footer.
- PRs should explain intent, include testing evidence (manual steps or canvas screenshots), and link issues.
- Call out any changes to `public/data/graph.mmd` so reviewers can regenerate narratives.

## Graph Data Workflow
- Preserve indentation in `graph.mmd` generated by the script; avoid manual edits except quick patches.
- When expanding the storyline, update metadata in `scripts/gen-tree-progressive.js` and rerun the script to keep phases in sync.

## Agent-Specific Notes
- Follow these guidelines for all changes within this repoâ€™s scope. Make minimal, focused patches; do not rename or restructure files without clear need. Honor existing style and conventions.

